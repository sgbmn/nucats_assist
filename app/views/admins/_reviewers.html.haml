%table.table.table-bordered
  %tr
    %th Username
    %th Name
    %th Phone
    %th
  - reviewers.each do |reviewer|
    - user = reviewer.user
    - div_id = "assigned_submissions_#{user.id}"
    %tr
      %td
        = h reviewer.user.username
      %td
        - unless reviewer.user.email.blank?
          = mail_to(user.email, user.name, subject: 'From NUCATS Assist', encode: 'javascript',   title: "Send email to #{user.name}")
      %td
        = h user.business_phone
      %td
        = link_to('Edit', edit_applicant_path(user.id), title: "Edit #{user.name}'s profile")
        = link_to('Remove', remove_reviewer_project_admin_path(project_id: project.id, id: reviewer.id), title: "Remove #{user.name} as a reviewer", confirm: 'Are you sure you want to delete this reviewer? This will delete any reviews associated with this reviewer!')
    %tr
      %td{:style => "text-align:right;"}
        Assigned:
      %td{:colspan => "3"}
        %div{:id => div_id}
          = render 'assigned_submissions', reviewer: user, project: project
    / START: styles
    :css
      ##{div_id} ul li {
        list-style: none;
        cursor: -moz-grab;
      }
      / ##{div_id} {
      /   border: 1px solid gray;
      / }
    / START: define targets
    :coffee
      $("##{div_id}").droppable
        tolerance: "pointer"
        hoverClass: "hover"
        drop: (event, ui) ->
          $.ajax
            type: 'POST'
            dataType: 'script'
            url: "#{assign_submission_project_admin_url(project.id, user.id)}"
            data:
              submission_id: ui.draggable.data('id')
              authenticity_token: "#{form_authenticity_token}"

    / = drop_receiving_element(div_id, accept: 'unassigned_submission', hoverclass: 'hover',       with: "'submission_id=' + encodeURIComponent(element.id.split('_').last())", url: { action: :assign_submission, id: user }) 
    / END: define targets